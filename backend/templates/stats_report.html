<!-- backend/templates/stats_report.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HRMS Office Report - {{ report_year }}</title>
    <style>
        /* Simple embedded styling ensures wkhtmltopdf picks it up cleanly */
        body { font-family: "Segoe UI", Arial, sans-serif; color: #222; margin: 20px; }
        .header { display:flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .brand { }
        .brand h1 { margin: 0; font-size: 20px; color: #0d6efd; }
        .brand p { margin: 2px 0 0; font-size: 12px; color: #333; }
        .meta { text-align: right; font-size: 12px; }
        .meta strong { color: #155724; }
        .company { margin-top: 6px; font-size: 13px; color: #444; }
        hr { border: none; height: 6px; background: linear-gradient(90deg,#0d6efd,#198754,#ffc107,#dc3545); border-radius: 6px; margin: 14px 0; }

        .section { margin-top: 14px; }
        .section h2 { font-size: 16px; margin-bottom: 8px; color: #0d6efd; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 8px; font-size: 12px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: #f1f7ff; color: #0d6efd; font-weight: 700; }
        .muted { color: #666; font-size: 12px; margin-bottom: 10px; }
        .small { font-size: 11px; color: #666; }
        .highlight-high { background:#e6f4ea; }
        .highlight-low { background:#fdecea; }
    </style>
</head>
<body>
    <div class="header">
        <div class="brand">
            <h1>HRMS Office Report — {{ report_year }}</h1>
            {% if company_name %}
                <p class="company"><strong>{{ company_name }}</strong>{% if company_details %} — {{ company_details }}{% endif %}</p>
            {% else %}
                <p class="company muted">Generated by HRMS</p>
            {% endif %}
        </div>

        <div class="meta">
            <div>Generated: <strong>{{ generated_on }}</strong></div>
            <div class="small">Time: {{ generated_time }}</div>
        </div>
    </div>

    <hr />

    {% for section, rows in stats.items() %}
        <div class="section">
            <h2>{{ section.replace('_', ' ').title() }}</h2>

            {% if rows %}
                <table>
                    <thead>
                        <tr>
                            {% for col in rows[0]._mapping.keys() %}
                                <th>{{ col.replace('_', ' ').title() }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in rows %}
                            <tr>
                                {% for col, value in row._mapping.items() %}
                                    <td class="{% if col == 'current_salary' and value is number and value > 70000 %}highlight-high{% elif col == 'current_salary' and value is number and value < 40000 %}highlight-low{% endif %}">
                                        {{ value }}
                                    </td>
                                {% endfor %}
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <div class="small muted">No data available for this section.</div>
            {% endif %}
        </div>
    {% endfor %}

    <div class="small muted" style="margin-top:18px;">
        Report generated by HRMS • Confidential
    </div>
</body>
</html>
